#!/usr/bin/env bash

# $1 : dir
# $2 : indent size

_echo () { test -n "$1" && eval printf "%$1c" 1 | tr '1' ' ' ; shift ; echo "$@" ; }

test $# -eq 0 && exit 0

! test -d "$1" && exit 0

_echo "$2" '{type:"directory","name": "'$(basename $1)'","contents":["'

for i in "$1"/*
do
    if test -d "$i" ; then
        $0 "$i" "$(($2 + 2))"
    fi
done
_echo  "$2" ']}'
